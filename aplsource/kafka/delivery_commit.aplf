 r←delivery_commit cons;topic;tlength;partition;offset;err;tlen;part;partlen;partslen;parts;offsets;offsetslen;len;msg;length;errln;z;errln;listlen
  (z topic tlen parts offsets err listlen)←7↑CommitReport cons 512 1 512 512 512 1
 :Select z
 :Case 0   ⍝ we got a message
     r←0 ('Topics: ',tlen↑topic) ('Partitions: ',listlen↑parts) ('Offsets: ',listlen↑offsets)
 :Else    ⍝ Kafka error
     r←z ('Error: ',listlen↑err)
 :EndSelect
